$.fn.Menu=function(e){function n(){$(".menucontents UL").addClass("OfficeUI_nowrap OfficeUI_nopadding OfficeUI_nomargin");$(".menu").addClass("OfficeUI_absolute")}function i(){return{Show:s,Hide:o,OpenContextMenu:u}}function s(){if(e.Animate){t.show("slide",{direction:e.AnimateDirection},e.TransitionTime).Activate()}else{t.show()}}function o(){t.hide()}function u(n){n.preventDefault();var r=$(".contextMenuInArea").height();var i=$(".contextMenuInArea").width();leftVal=n.pageX-i/2+"px";topVal=n.pageY-r/2+"px";if(e.Animate){t.css({left:leftVal,top:topVal}).show("slide",{direction:e.AnimateDirection},e.TransitionTime).Activate()}else{t.css({left:leftVal,top:topVal}).show()}return false}var e=$.extend({Animate:true,AnimateDirection:"up",AnimateDirectionSubMenu:"left",DelayTime:500,TransitionTime:100},e);var t=$(this);n();var r;$("LI.menuEntry:not(.OfficeUI_disabled)").on("click",function(t){t.stopPropagation();clearTimeout(r);if($(".subMenuHolder",this).length>0){var n=$(this);transitionDirection=e.AnimateDirectionSubMenu;$(".menu",$(n).parent()).each(function(){$(this).hide().parent().Deactivate()});if(e.Animate){$(".menu",n).first().show("slide",{direction:transitionDirection},e.TransitionTime).Activate()}else{$(".menu",n).first().show()}}});$("LI.menuEntry:not(.OfficeUI_disabled)").on("mouseenter",function(t){t.stopPropagation();var n=e.AnimateDirection;if($(".subMenuHolder",this).length>0){var i=$(this);n=e.AnimateDirectionSubMenu;r=setTimeout(function(){$(".menu",$(i).parent()).each(function(){$(this).hide().parent().Deactivate()});if(e.Animate){$(".menu",i).first().show("slide",{direction:n},e.TransitionTime).Activate()}else{$(".menu",i).first().show()}},e.DelayTime)}else{$(".menu",$(this).parent()).each(function(){$(this).hide().parent().Deactivate()})}});$("LI.menuEntry").on("mouseout",function(e){clearTimeout(r)});$(document).on("click",function(e){$(".menu").each(function(){$(this).hide().parent().Deactivate();$(this).data("state",0)})});return i()}