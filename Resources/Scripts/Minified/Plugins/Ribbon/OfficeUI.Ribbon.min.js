var OfficeUIConstants={menuTransition:100,subMenuTimeout:500};var settings;$.fn.RibbonFromJson=function(e,t){function o(e,t){if(t.AutoGenerateTabId==false){if(e.Id==null){r=false;return}}else{if(e.Id==null){e.Id=a().toUpperCase()}}if(e.Type=="Application"){n+=1;if(n>1){return;r=false}}else if(e.Type!="Normal"){return;r=false}}function u(e,t){var n=settings.RibbonTemplateFile;$.ajax({async:false,dataType:"text",url:n,success:function(n){var r=OfficeUITemplating.LoadTemplate("Ribbon template",n,e);$(t).append(r)},error:function(e,t,n){}})}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}function f(){$("ul[role='tablist'] > li").attr("role","tab");$(".ribbon, .tabs").addClass("brd_btm_grey");$(".tabs UL").addClass("OfficeUI_nowrap OfficeUI_nopadding OfficeUI_nomargin");$("li[role='tab']").addClass("OfficeUI_inline");$("li[role='tab'] span:first-child").addClass("OfficeUI_uppercase");$("li[role='tab'] .contents").addClass("OfficeUI_absolute");$(".group").after("<div class='seperator'>&nbsp;</div>");$(".group, .seperator").addClass("OfficeUI_relative OfficeUI_inline");$(".icongroup, .smallicon .iconlegend").addClass("OfficeUI_inline");$(".bigicon").addClass("icon OfficeUI_relative OfficeUI_inline OfficeUI_center");$(".smallicon").addClass("icon OfficeUI_relative");$(".legend").addClass("OfficeUI_absolute");$(".menucontents ul li.line").after('<li style="height: 1px; background-color: #D4D4D4; margin-left: 25px; "></li>');g($("li[role='tab']:not(.application)").first().Id());$("li[role=tab]:not(.application)").click(function(){g($(this).Id())});$(".ribbon").on("DOMMouseScroll mousewheel",function(e){if(e.originalEvent.detail>0||e.originalEvent.wheelDelta<0){l($(this))}else{c($(this))}return false});var e;var t;$(".icon").on("click",function(t){clearTimeout(e);$(".tooltip",$(this)).each(function(e){$(this).hide()});if(!$(this).hasClass("OfficeUI_disabled")){if($(this).HoldsMenu()){t.stopPropagation();h(OfficeUIConstants.menuTransition,$(".menu",this).first())}}});$(".icon").on("mouseenter",function(n){var r;clearTimeout(e);clearTimeout(t);$(".tooltip",$(this)).each(function(e){r=$(this)});if($(r).parent().hasClass("smallicon")){var i=$(r).parent();var s=$(i).parent().parents(".icongroup");$(".smallicon",s).each(function(e,t){if(t==i.get(0)){if(e==1){$(r).css("top","65px")}else if(e==2){$(r).css("top","41px")}}})}e=setTimeout(function(){$(r).show()},1e3);$(this).on("mouseout",function(e){t=setTimeout(function(){$(".tooltip").each(function(e){$(this).hide()})},500)})})}function l(){if($("li[role=tab].active").next().Id()!=null){g($($("li[role=tab].active").next()).Id())}}function c(){if(!$($("li[role=tab].active").prev()).hasClass("application")){g($($("li[role=tab]:not(.application).active").prev()).Id())}}function h(e,t){if(!$(t).data("state")||$(t).data("state")==0){$(".menu").each(function(){$(this).hide().parent().Deactivate();$(this).data("state",0)});$(t).parent().Activate();$(t).Menu().Show();$(t).data("state",1)}else if($(t).data("state")==1){$(".menu").each(function(){$(this).hide().parent().Deactivate();$(this).data("state",0)})}}function p(e){$(e).Menu().Hide();$(e).data("state",0)}function d(){return{ActivateAction:v,DeactivateAction:m,EnableTab:g}}function v(e){var t=$("#"+e);t.removeClass("OfficeUI_disabled")}function m(e){var t=$("#"+e);t.addClass("OfficeUI_disabled")}function g(e){if($("#"+e).LogWhenNotFound("[OfficeUI Ribbon]: Tab with id '"+e+"' not found.")){OfficeUICoreHelpers.DeactivateAllTabs();OfficeUICoreHelpers.ActivateTab(e)}}settings=$.extend({AutoGenerateTabId:false,RibbonTemplateFile:"",MenuArrowTemplateFile:"",Plugins:[]},t);var n=0;var r=true;var i=this;var s={ribbonId:""};if(settings.RibbonTemplateFile==""){return}$.ajax({dataType:"json",url:e,async:false,success:function(e){if(settings.Plugins!=""){$(settings.Plugins).each(function(t,n){n.PluginOptions["JsonData"]=e})}var n={PluginName:"Menu Plugin",PluginFunction:function(t){OfficeUIMenuPlugin.Initialize(t,e)},PluginOptions:$.extend({MenuArrowTemplateFile:t.MenuArrowTemplateFile,MenuTemplateFile:t.MenuTemplateFile})};settings.Plugins.unshift(n);if(e.Tabs==null){return;r=false}$(e.Tabs).each(function(e,t){if(o(t,settings)){r=true}});if(!r){log("%c [OfficeUI Ribbon]: The ribbon cannot be rendered since it's configuration is invalid.","color: red;");return}else{if(e.Id!=null){s.ribbonId=e.Id}s.tabs=[];$(e.Tabs).each(function(e,t){if(t.Type=="Application"){t.TabType="application"}else{t.TabType="normal"}$(t.Groups).each(function(e,t){$(t.IconGroups).each(function(e,t){$(t.Icons).each(function(e,t){if(t.Type=="Big"){t.IconType="bigicon"}else{t.IconType="smallicon"}})})})});u(e,i);f();$(settings.Plugins).each(function(e,t){t.PluginFunction(t.PluginOptions)})}},error:function(e,t,n){}});return d()};var OfficeUICoreHelpers={ActivateTab:function(e){$("#"+e).Activate();$(".contents",$("#"+e)).Activate()},DeactivateTab:function(e){$("#"+e).Deactivate();$(".contents",$("#"+e)).Deactivate()},DeactivateAllTabs:function(){$("li[role=tab]").each(function(e){OfficeUICoreHelpers.DeactivateTab($(this).Id())})}}