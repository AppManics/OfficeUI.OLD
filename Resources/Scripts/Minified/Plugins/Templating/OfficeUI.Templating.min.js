var emptyLinesRegex=/(<!--)(.)*(-->)/g;var importsRegex=/({{TMPL:Import=).*;( Name=).*}}/g;var importTemplateRegex=/(Import=).*;/g;var nameTemplateRegex=/(Name=).*(}})/g;var renderRegex=/({{Render:).*(}})/g;var renderNameRegex=/(:).*(;)/g;var renderObjectRegex=/(=).*(}})/g;var sequenceRegex=/({{BOS:Sequence}})[.]*?[\s\S]*?({{EOS:Sequence}})/g;var replaceWithObjectRegex=/({{)(?!TMPL|If|EndIf|[BE]OS|Render).*?(}})/g;var loadedTemplates=[];var OfficeUITemplating={LoadTemplate:function(e,t,n){var r=t;r=OfficeUITemplating.RemoveComments(r);var i=OfficeUITemplating.Process(r,n);return i},RemoveComments:function(e){return e.replace(emptyLinesRegex,"")},Process:function(e,t){var n=e.match(importsRegex);var r=e.match(sequenceRegex);var i;var s;var o=[];var u=[];o=OfficeUITemplating.GetAllImports(n);e=e.replace(importsRegex,"");if(r!=null){var a="";$(r).each(function(n,r){var a=r.replace(/({{BOS:Sequence}})/g,"").replace(/({{EOS:Sequence}})/g,"");var f="";i=e.match(renderRegex);s=e.match(replaceWithObjectRegex);$(t).each(function(e,t){var n=a;$(s).each(function(e,r){n=OfficeUITemplating.ReplacePlaceholdersWithObject(r,t,n)});OfficeUITemplating.ProcessIfStatements(n);$(i).each(function(e,t){u=OfficeUITemplating.GetAllRenderers(i)});$(u).each(function(e,t){OfficeUITemplating.ValidateRenderSections(o,t)});$(u).each(function(e,r){n=OfficeUITemplating.ReplaceRenderSectionWithData(o,r,t,n)});f+=n});e=e.replace(r,f)})}i=e.match(renderRegex);s=e.match(replaceWithObjectRegex);u=OfficeUITemplating.GetAllRenderers(i);$(u).each(function(e,t){OfficeUITemplating.ValidateRenderSections(o,t)});e=OfficeUITemplating.ProcessIfStatements(e);$(s).each(function(n,r){e=OfficeUITemplating.ReplacePlaceholdersWithObject(r,t,e)});$(u).each(function(n,r){e=OfficeUITemplating.ReplaceRenderSectionWithData(o,r,t,e)});return e},ProcessIfStatements:function(renderedData){var ifStatementRegex=/({{If ).*(}})/g;var completeConditionRegexBAK=/({{If)[.]*?[\s\S]*?({{EndIf}})/g;var completeConditionRegex=/({{If).*[\s\S]*({{EndIf}})/g;var allTemplateConditions=renderedData.match(completeConditionRegex);if(renderedData.match(completeConditionRegex)!=null){}$(allTemplateConditions).each(function(index,completeCondition){var ifStatementCondition=completeCondition.match(ifStatementRegex)[0];var condition=ifStatementCondition.replace(/({{If )/g,"").replace(/(}})/g,"");if(!eval(condition)){renderedData=renderedData.replace(/({{If)[.]*?[\s\S]*?({{EndIf}})/,"")}else{renderedData=renderedData.replace(/({{If ).*(}})/,"").replace(/({{EndIf}})/,"")}});if(renderedData.match(ifStatementRegex)==null){return renderedData}if(renderedData.match(ifStatementRegex).length>0){renderedData=OfficeUITemplating.ProcessIfStatements(renderedData)}if(renderedData.match(completeConditionRegex)!=null){}return renderedData},GetAllImports:function(e){var t=[];$(e).each(function(e,n){var r={TemplateName:"",Name:""};r.TemplateName=n.match(importTemplateRegex)[0].replace(/Import=/g,"").replace(/;/g,"");r.Name=n.match(nameTemplateRegex)[0].replace(/(Name=)/g,"").replace(/(}})/g,"");t.push(r)});return t},GetAllRenderers:function(e){var t=[];$(e).each(function(e,n){var r={RenderName:"",RenderObject:""};r.RenderName=n.match(renderNameRegex)[0].replace(/(:)/g,"").replace(/(;)/g,"");r.RenderObject=n.match(renderObjectRegex)[0].replace(/(=")/g,"").replace(/("}})/g,"");t.push(r)});return t},ValidateRenderSections:function(e,t){var n=jQuery.grep(e,function(e){return e.Name==t.RenderName});if(n==""){}},ReplaceRenderSectionWithData:function(e,t,n,r){var i="";jQuery.grep(e,function(e){if(e.Name==t.RenderName){i=e}});var s=n[t.RenderObject];var o=OfficeUITemplating.LoadChildTemplate(t.RenderName,i.TemplateName,s);return r.replace(/({{Render:).*(}})/g,o)},ReplacePlaceholdersWithObject:function(e,t,n){var r=e.replace(/({{)/g,"").replace(/(}})/g,"");var i=false;if(r.indexOf(":")!=-1){i=true;r=r.replace(/Required:/g,"")}if(t[r]!=null){return n.replace(e,t[r])}else{if(i){return}else{}}return n.replace(e,"")},LoadChildTemplate:function(e,t,n){var r="";jQuery.grep(loadedTemplates,function(e){if(e["FullyQualifiedName"]==t){r=e.TemplateData}});var i="";if(r!=""){i=OfficeUITemplating.LoadTemplate(e,r,n)}else{$.ajax({async:false,dataType:"text",url:t,success:function(r){var s={FullyQualifiedName:"",TemplateData:""};s.FullyQualifiedName=t;s.TemplateData=r;loadedTemplates.push(s);i=OfficeUITemplating.LoadTemplate(e,r,n)},error:function(e,t,n){}})}return i}}